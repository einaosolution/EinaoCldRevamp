import { Injectable, Optional, EventEmitter, ChangeDetectorRef, Component, Inject, NgModule, ApplicationRef, ComponentFactoryResolver, Directive, ElementRef, Injector, Input, Output, Renderer2, TemplateRef, ViewContainerRef, defineInjectable, inject } from '@angular/core';
import { __values } from 'tslib';
import { from, timer, Subscription } from 'rxjs';
import { animate, style, transition, trigger } from '@angular/animations';
import { CommonModule } from '@angular/common';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var InstanceConfigHolderService = /** @class */ (function () {
    function InstanceConfigHolderService() {
    }
    InstanceConfigHolderService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] },
    ];
    /** @nocollapse */
    InstanceConfigHolderService.ctorParameters = function () { return []; };
    /** @nocollapse */ InstanceConfigHolderService.ngInjectableDef = defineInjectable({ factory: function InstanceConfigHolderService_Factory() { return new InstanceConfigHolderService(); }, token: InstanceConfigHolderService, providedIn: "root" });
    return InstanceConfigHolderService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var BusyConfig = /** @class */ (function () {
    function BusyConfig(config) {
        var e_1, _a;
        if (config === void 0) { config = {}; }
        try {
            for (var _b = __values(Object.keys(BUSY_CONFIG_DEFAULTS)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var option = _c.value;
                this[option] = config[option] !== undefined ? config[option] : BUSY_CONFIG_DEFAULTS[option];
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
    }
    return BusyConfig;
}());
var DefaultBusyComponent = /** @class */ (function () {
    function DefaultBusyComponent(instanceConfigHolder) {
        this.instanceConfigHolder = instanceConfigHolder;
    }
    Object.defineProperty(DefaultBusyComponent.prototype, "message", {
        get: /**
         * @return {?}
         */
        function () {
            return this.instanceConfigHolder.config.message;
        },
        enumerable: true,
        configurable: true
    });
    DefaultBusyComponent.decorators = [
        { type: Component, args: [{
                    selector: 'default-busy',
                    template: "\n      <div class=\"ng-busy-default-wrapper\">\n          <div class=\"ng-busy-default-sign\">\n              <div class=\"ng-busy-default-spinner\">\n                  <div class=\"bar1\"></div>\n                  <div class=\"bar2\"></div>\n                  <div class=\"bar3\"></div>\n                  <div class=\"bar4\"></div>\n                  <div class=\"bar5\"></div>\n                  <div class=\"bar6\"></div>\n                  <div class=\"bar7\"></div>\n                  <div class=\"bar8\"></div>\n                  <div class=\"bar9\"></div>\n                  <div class=\"bar10\"></div>\n                  <div class=\"bar11\"></div>\n                  <div class=\"bar12\"></div>\n              </div>\n              <div class=\"ng-busy-default-text\">{{message}}</div>\n          </div>\n      </div>\n  ",
                },] },
    ];
    /** @nocollapse */
    DefaultBusyComponent.ctorParameters = function () { return [
        { type: InstanceConfigHolderService, decorators: [{ type: Inject, args: ['instanceConfigHolder',] }] }
    ]; };
    return DefaultBusyComponent;
}());
/** @type {?} */
var BUSY_CONFIG_DEFAULTS = {
    template: DefaultBusyComponent,
    templateNgStyle: {},
    delay: 0,
    minDuration: 0,
    backdrop: true,
    message: 'Please wait...',
    wrapperClass: 'ng-busy',
    disableAnimation: false
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
/**
 * @param {?} value
 * @return {?}
 */
function isPromise(value) {
    return value && typeof (/** @type {?} */ (value)).subscribe !== 'function' && typeof (/** @type {?} */ (value)).then === 'function';
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var BusyTrackerService = /** @class */ (function () {
    function BusyTrackerService() {
        this.isDelayProcessing = false;
        this.isDurationProcessing = false;
        this.isBusiesProcessing = false;
        this.busyQueue = [];
        this.__isActive = false;
        this.onStartBusy = new EventEmitter();
        this.onStopBusy = new EventEmitter();
    }
    Object.defineProperty(BusyTrackerService.prototype, "isActive", {
        get: /**
         * @return {?}
         */
        function () {
            return this.__isActive;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            if (this.__isActive === false && val === true && this.onStartBusy) {
                this.onStartBusy.emit();
            }
            if (this.__isActive === true && val === false && this.onStopBusy) {
                this.isBusiesProcessing = false;
                this.onStopBusy.emit();
            }
            this.__isActive = val;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BusyTrackerService.prototype, "busyList", {
        get: /**
         * @return {?}
         */
        function () {
            return this.busyQueue;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} options
     * @return {?}
     */
    BusyTrackerService.prototype.load = /**
     * @param {?} options
     * @return {?}
     */
    function (options) {
        this.loadBusyQueue(options.busyList);
        this.startLoading(options);
    };
    /**
     * @return {?}
     */
    BusyTrackerService.prototype.updateActiveStatus = /**
     * @return {?}
     */
    function () {
        this.isActive = this.isBusiesProcessing &&
            !this.isDelayProcessing &&
            (this.isDurationProcessing || this.busyQueue.length > 0);
    };
    /**
     * @param {?} options
     * @return {?}
     */
    BusyTrackerService.prototype.startLoading = /**
     * @param {?} options
     * @return {?}
     */
    function (options) {
        var _this = this;
        if (!this.isBusiesProcessing && this.busyList.length > 0) {
            this.isBusiesProcessing = true;
            this.isDelayProcessing = true;
            this.updateActiveStatus();
            timer(options.delay).subscribe(function () {
                _this.isDelayProcessing = false;
                _this.isDurationProcessing = true;
                _this.updateActiveStatus();
                timer(options.minDuration).subscribe(function () {
                    _this.isDurationProcessing = false;
                    _this.updateActiveStatus();
                });
            });
        }
    };
    /**
     * @param {?} busies
     * @return {?}
     */
    BusyTrackerService.prototype.loadBusyQueue = /**
     * @param {?} busies
     * @return {?}
     */
    function (busies) {
        var _this = this;
        busies.filter(function (busy) {
            return busy && !busy.hasOwnProperty('__loaded_mark_by_ng_busy');
        }).forEach(function (busy) {
            Object.defineProperty(busy, '__loaded_mark_by_ng_busy', {
                value: true, configurable: false, enumerable: false, writable: false
            });
            /** @type {?} */
            var cur_busy;
            if (isPromise(busy)) {
                cur_busy = from(busy).subscribe();
            }
            else {
                cur_busy = busy;
            }
            _this.appendToQueue(cur_busy);
        });
    };
    /**
     * @param {?} busy
     * @return {?}
     */
    BusyTrackerService.prototype.appendToQueue = /**
     * @param {?} busy
     * @return {?}
     */
    function (busy) {
        var _this = this;
        this.busyQueue.push(busy);
        busy.add(function () {
            _this.busyQueue = _this.busyQueue.filter(function (cur) { return !cur.closed; });
            _this.updateActiveStatus();
        });
    };
    /**
     * @return {?}
     */
    BusyTrackerService.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
    };
    BusyTrackerService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] },
    ];
    /** @nocollapse */
    BusyTrackerService.ctorParameters = function () { return []; };
    /** @nocollapse */ BusyTrackerService.ngInjectableDef = defineInjectable({ factory: function BusyTrackerService_Factory() { return new BusyTrackerService(); }, token: BusyTrackerService, providedIn: "root" });
    return BusyTrackerService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var BusyConfigHolderService = /** @class */ (function () {
    function BusyConfigHolderService(config) {
        this.config = Object.assign({}, BUSY_CONFIG_DEFAULTS, config || new BusyConfig());
    }
    BusyConfigHolderService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] },
    ];
    /** @nocollapse */
    BusyConfigHolderService.ctorParameters = function () { return [
        { type: BusyConfig, decorators: [{ type: Optional }] }
    ]; };
    /** @nocollapse */ BusyConfigHolderService.ngInjectableDef = defineInjectable({ factory: function BusyConfigHolderService_Factory() { return new BusyConfigHolderService(inject(BusyConfig, 8)); }, token: BusyConfigHolderService, providedIn: "root" });
    return BusyConfigHolderService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
/** @type {?} */
var inactiveStyle = style({
    opacity: 0,
    transform: 'translateY(-40px)'
});
/** @type {?} */
var timing = '.3s ease';
var NgBusyComponent = /** @class */ (function () {
    function NgBusyComponent(instanceConfigHolder, busyEmitter, cdr) {
        var _this = this;
        this.instanceConfigHolder = instanceConfigHolder;
        this.busyEmitter = busyEmitter;
        this.cdr = cdr;
        this.disableAnimation = false;
        this.showBackdrop = true;
        this.isActive = false;
        this.busyMonitor = this.busyEmitter.subscribe(function (isActive) {
            /** @type {?} */
            var config = _this.instanceConfigHolder.config;
            _this.isActive = isActive;
            _this.wrapperClass = config.wrapperClass;
            _this.showBackdrop = config.backdrop;
            _this.disableAnimation = config.disableAnimation;
            if (_this.cdr) {
                _this.cdr.markForCheck();
            }
        });
    }
    /**
     * @return {?}
     */
    NgBusyComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.busyMonitor) {
            this.busyMonitor.unsubscribe();
        }
    };
    NgBusyComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-ng-busy',
                    template: "<div [class]=\"wrapperClass\" @flyInOut [@.disabled]=\"disableAnimation\" *ngIf=\"isActive\">\n  <ng-content></ng-content>\n</div>\n<div class=\"ng-busy-backdrop\" @flyInOut [@.disabled]=\"disableAnimation\" *ngIf=\"showBackdrop && isActive\">\n</div>\n",
                    styles: [""],
                    animations: [
                        trigger('flyInOut', [
                            transition('void => *', [
                                inactiveStyle,
                                animate(timing)
                            ]),
                            transition('* => void', [
                                animate(timing, inactiveStyle)
                            ])
                        ])
                    ]
                },] },
    ];
    /** @nocollapse */
    NgBusyComponent.ctorParameters = function () { return [
        { type: InstanceConfigHolderService, decorators: [{ type: Inject, args: ['instanceConfigHolder',] }] },
        { type: EventEmitter, decorators: [{ type: Inject, args: ['busyEmitter',] }] },
        { type: ChangeDetectorRef }
    ]; };
    return NgBusyComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var NgBusyDirective = /** @class */ (function () {
    function NgBusyDirective(configHolder, instanceConfigHolder, resolver, tracker, appRef, vcr, element, renderer, injector) {
        var _this = this;
        this.configHolder = configHolder;
        this.instanceConfigHolder = instanceConfigHolder;
        this.resolver = resolver;
        this.tracker = tracker;
        this.appRef = appRef;
        this.vcr = vcr;
        this.element = element;
        this.renderer = renderer;
        this.injector = injector;
        this.busyStart = new EventEmitter();
        this.busyStop = new EventEmitter();
        this.isLoading = false;
        this.busyEmitter = new EventEmitter();
        this.onStartSubscription = tracker.onStartBusy.subscribe(function () {
            setTimeout(function () {
                _this.recreateBusyIfNecessary();
                _this.isLoading = true;
                _this.busyEmitter.emit(_this.isLoading);
                _this.busyStart.emit();
            }, 0);
        });
        this.onStopSubscription = tracker.onStopBusy.subscribe(function () {
            _this.isLoading = false;
            _this.busyEmitter.emit(_this.isLoading);
            _this.busyStop.emit();
        });
    }
    Object.defineProperty(NgBusyDirective.prototype, "options", {
        get: /**
         * @return {?}
         */
        function () {
            return this._option;
        },
        set: /**
         * @param {?} op
         * @return {?}
         */
        function (op) {
            this._option = op;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    NgBusyDirective.prototype.ngDoCheck = /**
     * @return {?}
     */
    function () {
        this.optionsNorm = this.normalizeOptions(this.options);
        this.instanceConfigHolder.config = this.optionsNorm;
        this.tracker.load({
            busyList: this.optionsNorm.busy,
            delay: this.optionsNorm.delay,
            minDuration: this.optionsNorm.minDuration
        });
    };
    /**
     * @return {?}
     */
    NgBusyDirective.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.destroyComponents();
        this.onStartSubscription.unsubscribe();
        this.onStopSubscription.unsubscribe();
    };
    /**
     * @return {?}
     */
    NgBusyDirective.prototype.recreateBusyIfNecessary = /**
     * @return {?}
     */
    function () {
        if (!this.busyRef
            || this.template !== this.optionsNorm.template
            || this.templateNgStyle !== this.optionsNorm.templateNgStyle) {
            this.destroyComponents();
            this.template = this.optionsNorm.template;
            this.templateNgStyle = this.optionsNorm.templateNgStyle;
            this.createBusy();
            this.busyEmitter.emit(this.isLoading);
        }
    };
    /**
     * @param {?} options
     * @return {?}
     */
    NgBusyDirective.prototype.normalizeOptions = /**
     * @param {?} options
     * @return {?}
     */
    function (options) {
        if (!options) {
            options = { busy: [] };
        }
        else if (Array.isArray(options)
            || isPromise(options)
            || options instanceof Subscription) {
            options = { busy: options };
        }
        options = Object.assign({}, this.configHolder.config, options);
        if (!Array.isArray(options.busy)) {
            options.busy = [options.busy];
        }
        return options;
    };
    /**
     * @return {?}
     */
    NgBusyDirective.prototype.destroyComponents = /**
     * @return {?}
     */
    function () {
        if (this.busyRef) {
            this.busyRef.destroy();
        }
        if (this.componentViewRef) {
            this.appRef.detachView(this.componentViewRef);
        }
    };
    /**
     * @return {?}
     */
    NgBusyDirective.prototype.createBusy = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var factory = this.resolver.resolveComponentFactory(NgBusyComponent);
        /** @type {?} */
        var injector = Injector.create({
            providers: [
                {
                    provide: 'instanceConfigHolder',
                    useValue: this.instanceConfigHolder
                },
                {
                    provide: 'busyEmitter',
                    useValue: this.busyEmitter
                }
            ], parent: this.injector
        });
        this.template = this.optionsNorm.template;
        this.busyRef = this.vcr.createComponent(factory, 0, injector, this.generateNgContent(injector));
    };
    /**
     * @param {?} injector
     * @return {?}
     */
    NgBusyDirective.prototype.generateNgContent = /**
     * @param {?} injector
     * @return {?}
     */
    function (injector) {
        if (typeof this.template === 'string') {
            /** @type {?} */
            var element = this.renderer.createText(this.template);
            return [[element]];
        }
        if (this.template instanceof TemplateRef) {
            /** @type {?} */
            var context = {};
            /** @type {?} */
            var viewRef = this.template.createEmbeddedView(context);
            return [viewRef.rootNodes];
        }
        /** @type {?} */
        var factory = this.resolver.resolveComponentFactory(this.template);
        /** @type {?} */
        var componentRef = factory.create(injector);
        componentRef.instance.templateNgStyle = this.options.templateNgStyle;
        this.componentViewRef = componentRef.hostView;
        this.appRef.attachView(this.componentViewRef);
        return [[componentRef.location.nativeElement]];
    };
    NgBusyDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[ngBusy]',
                    providers: [BusyTrackerService, InstanceConfigHolderService]
                },] },
    ];
    /** @nocollapse */
    NgBusyDirective.ctorParameters = function () { return [
        { type: BusyConfigHolderService },
        { type: InstanceConfigHolderService },
        { type: ComponentFactoryResolver },
        { type: BusyTrackerService },
        { type: ApplicationRef },
        { type: ViewContainerRef },
        { type: ElementRef },
        { type: Renderer2 },
        { type: Injector }
    ]; };
    NgBusyDirective.propDecorators = {
        options: [{ type: Input, args: ['ngBusy',] }],
        busyStart: [{ type: Output }],
        busyStop: [{ type: Output }]
    };
    return NgBusyDirective;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var NgBusyModule = /** @class */ (function () {
    function NgBusyModule() {
    }
    /**
     * @param {?} config
     * @return {?}
     */
    NgBusyModule.forRoot = /**
     * @param {?} config
     * @return {?}
     */
    function (config) {
        return {
            ngModule: NgBusyModule,
            providers: [
                { provide: BusyConfig, useValue: config }
            ]
        };
    };
    NgBusyModule.decorators = [
        { type: NgModule, args: [{
                    imports: [CommonModule],
                    declarations: [DefaultBusyComponent, NgBusyDirective, NgBusyComponent],
                    providers: [BusyConfigHolderService, BusyTrackerService],
                    exports: [NgBusyDirective],
                    entryComponents: [DefaultBusyComponent, NgBusyComponent]
                },] },
    ];
    return NgBusyModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */

export { NgBusyDirective, InstanceConfigHolderService, NgBusyModule, BusyConfig, DefaultBusyComponent, BUSY_CONFIG_DEFAULTS, NgBusyComponent as ɵc, BusyConfigHolderService as ɵb, BusyTrackerService as ɵa };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmctYnVzeS5qcy5tYXAiLCJzb3VyY2VzIjpbIm5nOi8vbmctYnVzeS9saWIvc2VydmljZS9pbnN0YW5jZS1jb25maWctaG9sZGVyLnNlcnZpY2UudHMiLCJuZzovL25nLWJ1c3kvbGliL21vZGVsL2J1c3ktY29uZmlnLnRzIiwibmc6Ly9uZy1idXN5L2xpYi91dGlsL2lzUHJvbWlzZS50cyIsIm5nOi8vbmctYnVzeS9saWIvc2VydmljZS9idXN5LXRyYWNrZXIuc2VydmljZS50cyIsIm5nOi8vbmctYnVzeS9saWIvc2VydmljZS9idXN5LWNvbmZpZy1ob2xkZXIuc2VydmljZS50cyIsIm5nOi8vbmctYnVzeS9saWIvY29tcG9uZW50L25nLWJ1c3kvbmctYnVzeS5jb21wb25lbnQudHMiLCJuZzovL25nLWJ1c3kvbGliL25nLWJ1c3kuZGlyZWN0aXZlLnRzIiwibmc6Ly9uZy1idXN5L2xpYi9uZy1idXN5Lm1vZHVsZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0lCdXN5Q29uZmlnfSBmcm9tICcuLi9tb2RlbC9idXN5LWNvbmZpZyc7XG5cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIEluc3RhbmNlQ29uZmlnSG9sZGVyU2VydmljZSB7XG4gIHB1YmxpYyBjb25maWc6IElCdXN5Q29uZmlnO1xuICBjb25zdHJ1Y3RvcigpIHsgfVxufVxuIiwiaW1wb3J0IHtTdWJzY3JpcHRpb259IGZyb20gJ3J4anMnO1xuaW1wb3J0IHtDb21wb25lbnQsIFRlbXBsYXRlUmVmLCBUeXBlLCBJbmplY3QsIENoYW5nZURldGVjdG9yUmVmfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7SW5zdGFuY2VDb25maWdIb2xkZXJTZXJ2aWNlfSBmcm9tICcuLi9zZXJ2aWNlL2luc3RhbmNlLWNvbmZpZy1ob2xkZXIuc2VydmljZSc7XG5cbmV4cG9ydCBjbGFzcyBCdXN5Q29uZmlnIGltcGxlbWVudHMgSUJ1c3lDb25maWcge1xuICB0ZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PiB8IFR5cGU8YW55PjtcbiAgdGVtcGxhdGVOZ1N0eWxlOiB7fTtcbiAgZGVsYXk6IG51bWJlcjtcbiAgbWluRHVyYXRpb246IG51bWJlcjtcbiAgYmFja2Ryb3A6IGJvb2xlYW47XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgd3JhcHBlckNsYXNzOiBzdHJpbmc7XG4gIGRpc2FibGVBbmltYXRpb246IGJvb2xlYW47XG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBJQnVzeUNvbmZpZyA9IHt9KSB7XG4gICAgZm9yIChjb25zdCBvcHRpb24gb2YgT2JqZWN0LmtleXMoQlVTWV9DT05GSUdfREVGQVVMVFMpKSB7XG4gICAgICB0aGlzW29wdGlvbl0gPSBjb25maWdbb3B0aW9uXSAhPT0gdW5kZWZpbmVkID8gY29uZmlnW29wdGlvbl0gOiBCVVNZX0NPTkZJR19ERUZBVUxUU1tvcHRpb25dO1xuICAgIH1cbiAgfVxufVxuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdkZWZhdWx0LWJ1c3knLFxuICB0ZW1wbGF0ZTogYFxuICAgICAgPGRpdiBjbGFzcz1cIm5nLWJ1c3ktZGVmYXVsdC13cmFwcGVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm5nLWJ1c3ktZGVmYXVsdC1zaWduXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJuZy1idXN5LWRlZmF1bHQtc3Bpbm5lclwiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJhcjFcIj48L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJiYXIyXCI+PC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYmFyM1wiPjwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJhcjRcIj48L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJiYXI1XCI+PC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYmFyNlwiPjwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJhcjdcIj48L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJiYXI4XCI+PC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYmFyOVwiPjwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJhcjEwXCI+PC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYmFyMTFcIj48L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJiYXIxMlwiPjwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm5nLWJ1c3ktZGVmYXVsdC10ZXh0XCI+e3ttZXNzYWdlfX08L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICBgLFxufSlcbmV4cG9ydCBjbGFzcyBEZWZhdWx0QnVzeUNvbXBvbmVudCB7XG5cbiAgY29uc3RydWN0b3IoQEluamVjdCgnaW5zdGFuY2VDb25maWdIb2xkZXInKSBwcml2YXRlIGluc3RhbmNlQ29uZmlnSG9sZGVyOiBJbnN0YW5jZUNvbmZpZ0hvbGRlclNlcnZpY2UpIHtcbiAgfVxuXG4gIGdldCBtZXNzYWdlKCkge1xuICAgIHJldHVybiB0aGlzLmluc3RhbmNlQ29uZmlnSG9sZGVyLmNvbmZpZy5tZXNzYWdlO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUJ1c3lDb25maWcge1xuICB0ZW1wbGF0ZT86IFRlbXBsYXRlUmVmPGFueT4gfCBUeXBlPGFueT47XG4gIHRlbXBsYXRlTmdTdHlsZT86IHt9O1xuICBkZWxheT86IG51bWJlcjtcbiAgbWluRHVyYXRpb24/OiBudW1iZXI7XG4gIGJhY2tkcm9wPzogYm9vbGVhbjtcbiAgbWVzc2FnZT86IHN0cmluZztcbiAgd3JhcHBlckNsYXNzPzogc3RyaW5nO1xuICBidXN5PzogQXJyYXk8UHJvbWlzZTxhbnk+IHwgU3Vic2NyaXB0aW9uPjtcbiAgZGlzYWJsZUFuaW1hdGlvbj86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjb25zdCBCVVNZX0NPTkZJR19ERUZBVUxUUyA9IHtcbiAgdGVtcGxhdGU6IERlZmF1bHRCdXN5Q29tcG9uZW50LFxuICB0ZW1wbGF0ZU5nU3R5bGU6IHt9LFxuICBkZWxheTogMCxcbiAgbWluRHVyYXRpb246IDAsXG4gIGJhY2tkcm9wOiB0cnVlLFxuICBtZXNzYWdlOiAnUGxlYXNlIHdhaXQuLi4nLFxuICB3cmFwcGVyQ2xhc3M6ICduZy1idXN5JyxcbiAgZGlzYWJsZUFuaW1hdGlvbjogZmFsc2Vcbn07XG4iLCJleHBvcnQgZnVuY3Rpb24gaXNQcm9taXNlKHZhbHVlOiBhbnkpOiB2YWx1ZSBpcyBQcm9taXNlTGlrZTxhbnk+IHtcbiAgcmV0dXJuIHZhbHVlICYmIHR5cGVvZiAoPGFueT52YWx1ZSkuc3Vic2NyaWJlICE9PSAnZnVuY3Rpb24nICYmIHR5cGVvZiAodmFsdWUgYXMgYW55KS50aGVuID09PSAnZnVuY3Rpb24nO1xufVxuIiwiaW1wb3J0IHtFdmVudEVtaXR0ZXIsIEluamVjdGFibGUsIE9uRGVzdHJveX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1N1YnNjcmlwdGlvbiwgZnJvbSwgdGltZXJ9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHtpc1Byb21pc2V9IGZyb20gJy4uL3V0aWwvaXNQcm9taXNlJztcblxuZXhwb3J0IGludGVyZmFjZSBUcmFja2VyT3B0aW9ucyB7XG4gIG1pbkR1cmF0aW9uOiBudW1iZXI7XG4gIGRlbGF5OiBudW1iZXI7XG4gIGJ1c3lMaXN0OiBBcnJheTxQcm9taXNlPGFueT4gfCBTdWJzY3JpcHRpb24+O1xufVxuXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46ICdyb290J1xufSlcbmV4cG9ydCBjbGFzcyBCdXN5VHJhY2tlclNlcnZpY2UgaW1wbGVtZW50cyBPbkRlc3Ryb3kge1xuXG4gIHByaXZhdGUgaXNEZWxheVByb2Nlc3NpbmcgPSBmYWxzZTtcbiAgcHJpdmF0ZSBpc0R1cmF0aW9uUHJvY2Vzc2luZyA9IGZhbHNlO1xuICBwcml2YXRlIGlzQnVzaWVzUHJvY2Vzc2luZyA9IGZhbHNlO1xuICBwcml2YXRlIGJ1c3lRdWV1ZTogQXJyYXk8U3Vic2NyaXB0aW9uPiA9IFtdO1xuICBwcml2YXRlIF9faXNBY3RpdmUgPSBmYWxzZTtcblxuICBvblN0YXJ0QnVzeTogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIG9uU3RvcEJ1c3k6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gIGdldCBpc0FjdGl2ZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fX2lzQWN0aXZlO1xuICB9XG5cbiAgc2V0IGlzQWN0aXZlKHZhbDogYm9vbGVhbikge1xuICAgIGlmICh0aGlzLl9faXNBY3RpdmUgPT09IGZhbHNlICYmIHZhbCA9PT0gdHJ1ZSAmJiB0aGlzLm9uU3RhcnRCdXN5KSB7XG4gICAgICB0aGlzLm9uU3RhcnRCdXN5LmVtaXQoKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuX19pc0FjdGl2ZSA9PT0gdHJ1ZSAmJiB2YWwgPT09IGZhbHNlICYmIHRoaXMub25TdG9wQnVzeSkge1xuICAgICAgdGhpcy5pc0J1c2llc1Byb2Nlc3NpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMub25TdG9wQnVzeS5lbWl0KCk7XG4gICAgfVxuICAgIHRoaXMuX19pc0FjdGl2ZSA9IHZhbDtcbiAgfVxuICBnZXQgYnVzeUxpc3QoKSB7XG4gICAgcmV0dXJuIHRoaXMuYnVzeVF1ZXVlO1xuICB9XG5cbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIGxvYWQob3B0aW9uczogVHJhY2tlck9wdGlvbnMpIHtcbiAgICB0aGlzLmxvYWRCdXN5UXVldWUob3B0aW9ucy5idXN5TGlzdCk7XG4gICAgdGhpcy5zdGFydExvYWRpbmcob3B0aW9ucyk7XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZUFjdGl2ZVN0YXR1cygpIHtcbiAgICB0aGlzLmlzQWN0aXZlID0gdGhpcy5pc0J1c2llc1Byb2Nlc3NpbmcgJiZcbiAgICAgICF0aGlzLmlzRGVsYXlQcm9jZXNzaW5nICYmXG4gICAgICAodGhpcy5pc0R1cmF0aW9uUHJvY2Vzc2luZyB8fCB0aGlzLmJ1c3lRdWV1ZS5sZW5ndGggPiAwKTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhcnRMb2FkaW5nKG9wdGlvbnM6IFRyYWNrZXJPcHRpb25zKSB7XG4gICAgaWYgKCF0aGlzLmlzQnVzaWVzUHJvY2Vzc2luZyAmJiB0aGlzLmJ1c3lMaXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMuaXNCdXNpZXNQcm9jZXNzaW5nID0gdHJ1ZTtcbiAgICAgIHRoaXMuaXNEZWxheVByb2Nlc3NpbmcgPSB0cnVlO1xuICAgICAgdGhpcy51cGRhdGVBY3RpdmVTdGF0dXMoKTtcbiAgICAgIHRpbWVyKG9wdGlvbnMuZGVsYXkpLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgIHRoaXMuaXNEZWxheVByb2Nlc3NpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pc0R1cmF0aW9uUHJvY2Vzc2luZyA9IHRydWU7XG4gICAgICAgIHRoaXMudXBkYXRlQWN0aXZlU3RhdHVzKCk7XG4gICAgICAgIHRpbWVyKG9wdGlvbnMubWluRHVyYXRpb24pLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5pc0R1cmF0aW9uUHJvY2Vzc2luZyA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMudXBkYXRlQWN0aXZlU3RhdHVzKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBsb2FkQnVzeVF1ZXVlKGJ1c2llczogQXJyYXk8UHJvbWlzZTxhbnk+IHwgU3Vic2NyaXB0aW9uPikge1xuICAgIGJ1c2llcy5maWx0ZXIoKGJ1c3kpID0+IHtcbiAgICAgIHJldHVybiBidXN5ICYmICFidXN5Lmhhc093blByb3BlcnR5KCdfX2xvYWRlZF9tYXJrX2J5X25nX2J1c3knKTtcbiAgICB9KS5mb3JFYWNoKChidXN5OiBQcm9taXNlPGFueT4gfCBTdWJzY3JpcHRpb24pID0+IHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShidXN5LCAnX19sb2FkZWRfbWFya19ieV9uZ19idXN5Jywge1xuICAgICAgICB2YWx1ZTogdHJ1ZSwgY29uZmlndXJhYmxlOiBmYWxzZSwgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiBmYWxzZVxuICAgICAgfSk7XG4gICAgICBsZXQgY3VyX2J1c3k7XG4gICAgICBpZiAoaXNQcm9taXNlKGJ1c3kpKSB7XG4gICAgICAgIGN1cl9idXN5ID0gZnJvbShidXN5KS5zdWJzY3JpYmUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGN1cl9idXN5ID0gYnVzeTtcbiAgICAgIH1cbiAgICAgIHRoaXMuYXBwZW5kVG9RdWV1ZShjdXJfYnVzeSk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGFwcGVuZFRvUXVldWUoYnVzeTogU3Vic2NyaXB0aW9uKSB7XG4gICAgdGhpcy5idXN5UXVldWUucHVzaChidXN5KTtcbiAgICBidXN5LmFkZCgoKSA9PiB7XG4gICAgICB0aGlzLmJ1c3lRdWV1ZSA9IHRoaXMuYnVzeVF1ZXVlLmZpbHRlcigoY3VyOiBTdWJzY3JpcHRpb24pID0+ICFjdXIuY2xvc2VkKTtcbiAgICAgIHRoaXMudXBkYXRlQWN0aXZlU3RhdHVzKCk7XG4gICAgfSk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgfVxufVxuIiwiaW1wb3J0IHtJbmplY3RhYmxlLCBPcHRpb25hbH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0JVU1lfQ09ORklHX0RFRkFVTFRTLCBCdXN5Q29uZmlnfSBmcm9tICcuLi9tb2RlbC9idXN5LWNvbmZpZyc7XG5cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIEJ1c3lDb25maWdIb2xkZXJTZXJ2aWNlIHtcbiAgY29uZmlnOiBCdXN5Q29uZmlnO1xuXG4gIGNvbnN0cnVjdG9yKEBPcHRpb25hbCgpIGNvbmZpZzogQnVzeUNvbmZpZykge1xuICAgIHRoaXMuY29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgQlVTWV9DT05GSUdfREVGQVVMVFMsIGNvbmZpZyB8fCBuZXcgQnVzeUNvbmZpZygpKTtcbiAgfVxufVxuIiwiaW1wb3J0IHtDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIEluamVjdCwgT25EZXN0cm95fSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7YW5pbWF0ZSwgc3R5bGUsIHRyYW5zaXRpb24sIHRyaWdnZXJ9IGZyb20gJ0Bhbmd1bGFyL2FuaW1hdGlvbnMnO1xuaW1wb3J0IHtTdWJzY3JpcHRpb259IGZyb20gJ3J4anMvaW50ZXJuYWwvU3Vic2NyaXB0aW9uJztcbmltcG9ydCB7TmdCdXN5RGlyZWN0aXZlfSBmcm9tICcuLi8uLi9uZy1idXN5LmRpcmVjdGl2ZSc7XG5pbXBvcnQge0luc3RhbmNlQ29uZmlnSG9sZGVyU2VydmljZX0gZnJvbSAnLi4vLi4vc2VydmljZS9pbnN0YW5jZS1jb25maWctaG9sZGVyLnNlcnZpY2UnO1xuXG5jb25zdCBpbmFjdGl2ZVN0eWxlID0gc3R5bGUoe1xuICBvcGFjaXR5OiAwLFxuICB0cmFuc2Zvcm06ICd0cmFuc2xhdGVZKC00MHB4KSdcbn0pO1xuY29uc3QgdGltaW5nID0gJy4zcyBlYXNlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbGliLW5nLWJ1c3knLFxuICB0ZW1wbGF0ZTogYDxkaXYgW2NsYXNzXT1cIndyYXBwZXJDbGFzc1wiIEBmbHlJbk91dCBbQC5kaXNhYmxlZF09XCJkaXNhYmxlQW5pbWF0aW9uXCIgKm5nSWY9XCJpc0FjdGl2ZVwiPlxuICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XG48L2Rpdj5cbjxkaXYgY2xhc3M9XCJuZy1idXN5LWJhY2tkcm9wXCIgQGZseUluT3V0IFtALmRpc2FibGVkXT1cImRpc2FibGVBbmltYXRpb25cIiAqbmdJZj1cInNob3dCYWNrZHJvcCAmJiBpc0FjdGl2ZVwiPlxuPC9kaXY+XG5gLFxuICBzdHlsZXM6IFtgYF0sXG4gIGFuaW1hdGlvbnM6IFtcbiAgICB0cmlnZ2VyKCdmbHlJbk91dCcsIFtcbiAgICAgIHRyYW5zaXRpb24oJ3ZvaWQgPT4gKicsIFtcbiAgICAgICAgaW5hY3RpdmVTdHlsZSxcbiAgICAgICAgYW5pbWF0ZSh0aW1pbmcpXG4gICAgICBdKSxcbiAgICAgIHRyYW5zaXRpb24oJyogPT4gdm9pZCcsIFtcbiAgICAgICAgYW5pbWF0ZSh0aW1pbmcsIGluYWN0aXZlU3R5bGUpXG4gICAgICBdKVxuICAgIF0pXG4gIF1cbn0pXG5leHBvcnQgY2xhc3MgTmdCdXN5Q29tcG9uZW50IGltcGxlbWVudHMgT25EZXN0cm95IHtcblxuICBwdWJsaWMgd3JhcHBlckNsYXNzOiBzdHJpbmc7XG4gIHB1YmxpYyBkaXNhYmxlQW5pbWF0aW9uID0gZmFsc2U7XG4gIHB1YmxpYyBzaG93QmFja2Ryb3AgPSB0cnVlO1xuICBwcml2YXRlIHJlYWRvbmx5IGJ1c3lNb25pdG9yOiBTdWJzY3JpcHRpb247XG4gIGlzQWN0aXZlID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgQEluamVjdCgnaW5zdGFuY2VDb25maWdIb2xkZXInKSBwcml2YXRlIGluc3RhbmNlQ29uZmlnSG9sZGVyOiBJbnN0YW5jZUNvbmZpZ0hvbGRlclNlcnZpY2UsXG4gICAgQEluamVjdCgnYnVzeUVtaXR0ZXInKSBwcml2YXRlIGJ1c3lFbWl0dGVyOiBFdmVudEVtaXR0ZXI8Ym9vbGVhbj4sXG4gICAgcHJpdmF0ZSByZWFkb25seSBjZHI6IENoYW5nZURldGVjdG9yUmVmXG4gICkge1xuICAgIHRoaXMuYnVzeU1vbml0b3IgPSB0aGlzLmJ1c3lFbWl0dGVyLnN1YnNjcmliZSgoaXNBY3RpdmU6IGJvb2xlYW4pID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IHRoaXMuaW5zdGFuY2VDb25maWdIb2xkZXIuY29uZmlnO1xuICAgICAgdGhpcy5pc0FjdGl2ZSA9IGlzQWN0aXZlO1xuICAgICAgdGhpcy53cmFwcGVyQ2xhc3MgPSBjb25maWcud3JhcHBlckNsYXNzO1xuICAgICAgdGhpcy5zaG93QmFja2Ryb3AgPSBjb25maWcuYmFja2Ryb3A7XG4gICAgICB0aGlzLmRpc2FibGVBbmltYXRpb24gPSBjb25maWcuZGlzYWJsZUFuaW1hdGlvbjtcbiAgICAgIGlmICh0aGlzLmNkcikge1xuICAgICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmJ1c3lNb25pdG9yKSB7XG4gICAgICB0aGlzLmJ1c3lNb25pdG9yLnVuc3Vic2NyaWJlKCk7XG4gICAgfVxuICB9XG5cbn1cbiIsImltcG9ydCB7XG4gIEFwcGxpY2F0aW9uUmVmLFxuICBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIENvbXBvbmVudFJlZixcbiAgRGlyZWN0aXZlLCBEb0NoZWNrLFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsIEluamVjdG9yLFxuICBJbnB1dCwgT25EZXN0cm95LFxuICBPdXRwdXQsXG4gIFJlbmRlcmVyMixcbiAgVGVtcGxhdGVSZWYsIFR5cGUsXG4gIFZpZXdDb250YWluZXJSZWZcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBWaWV3UmVmIH0gZnJvbSAnQGFuZ3VsYXIvY29yZS9zcmMvbGlua2VyL3ZpZXdfcmVmJztcbmltcG9ydCB7IEJ1c3lUcmFja2VyU2VydmljZSB9IGZyb20gJy4vc2VydmljZS9idXN5LXRyYWNrZXIuc2VydmljZSc7XG5pbXBvcnQgeyBCdXN5Q29uZmlnSG9sZGVyU2VydmljZSB9IGZyb20gJy4vc2VydmljZS9idXN5LWNvbmZpZy1ob2xkZXIuc2VydmljZSc7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IElCdXN5Q29uZmlnIH0gZnJvbSAnLi9tb2RlbC9idXN5LWNvbmZpZyc7XG5pbXBvcnQgeyBOZ0J1c3lDb21wb25lbnQgfSBmcm9tICcuL2NvbXBvbmVudC9uZy1idXN5L25nLWJ1c3kuY29tcG9uZW50JztcbmltcG9ydCB7IEluc3RhbmNlQ29uZmlnSG9sZGVyU2VydmljZSB9IGZyb20gJy4vc2VydmljZS9pbnN0YW5jZS1jb25maWctaG9sZGVyLnNlcnZpY2UnO1xuaW1wb3J0IHsgaXNQcm9taXNlIH0gZnJvbSAnLi91dGlsL2lzUHJvbWlzZSc7XG5cbkBEaXJlY3RpdmUoe1xuICBzZWxlY3RvcjogJ1tuZ0J1c3ldJyxcbiAgcHJvdmlkZXJzOiBbQnVzeVRyYWNrZXJTZXJ2aWNlLCBJbnN0YW5jZUNvbmZpZ0hvbGRlclNlcnZpY2VdXG59KVxuZXhwb3J0IGNsYXNzIE5nQnVzeURpcmVjdGl2ZSBpbXBsZW1lbnRzIERvQ2hlY2ssIE9uRGVzdHJveSB7XG4gIEBJbnB1dCgnbmdCdXN5JylcbiAgc2V0IG9wdGlvbnMob3ApIHtcbiAgICB0aGlzLl9vcHRpb24gPSBvcDtcbiAgfVxuXG4gIGdldCBvcHRpb25zKCkge1xuICAgIHJldHVybiB0aGlzLl9vcHRpb247XG4gIH1cblxuICBAT3V0cHV0KCkgYnVzeVN0YXJ0ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICBAT3V0cHV0KCkgYnVzeVN0b3AgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIHByaXZhdGUgb3B0aW9uc05vcm06IElCdXN5Q29uZmlnO1xuICBwcml2YXRlIGJ1c3lSZWY6IENvbXBvbmVudFJlZjxOZ0J1c3lDb21wb25lbnQ+O1xuICBwcml2YXRlIGNvbXBvbmVudFZpZXdSZWY6IFZpZXdSZWY7XG4gIHByaXZhdGUgb25TdGFydFN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuICBwcml2YXRlIG9uU3RvcFN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuICBwcml2YXRlIGlzTG9hZGluZyA9IGZhbHNlO1xuICBwcml2YXRlIGJ1c3lFbWl0dGVyOiBFdmVudEVtaXR0ZXI8Ym9vbGVhbj4gPSBuZXcgRXZlbnRFbWl0dGVyPGJvb2xlYW4+KCk7XG4gIHB1YmxpYyB0ZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PiB8IFR5cGU8YW55PjtcbiAgcHVibGljIHRlbXBsYXRlTmdTdHlsZToge307XG4gIHByaXZhdGUgX29wdGlvbjogYW55O1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgY29uZmlnSG9sZGVyOiBCdXN5Q29uZmlnSG9sZGVyU2VydmljZSxcbiAgICBwcml2YXRlIGluc3RhbmNlQ29uZmlnSG9sZGVyOiBJbnN0YW5jZUNvbmZpZ0hvbGRlclNlcnZpY2UsXG4gICAgcHJpdmF0ZSByZXNvbHZlcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLFxuICAgIHByaXZhdGUgdHJhY2tlcjogQnVzeVRyYWNrZXJTZXJ2aWNlLFxuICAgIHByaXZhdGUgYXBwUmVmOiBBcHBsaWNhdGlvblJlZixcbiAgICBwcml2YXRlIHZjcjogVmlld0NvbnRhaW5lclJlZixcbiAgICBwcml2YXRlIGVsZW1lbnQ6IEVsZW1lbnRSZWYsXG4gICAgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyLFxuICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yKSB7XG4gICAgdGhpcy5vblN0YXJ0U3Vic2NyaXB0aW9uID0gdHJhY2tlci5vblN0YXJ0QnVzeS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRoaXMucmVjcmVhdGVCdXN5SWZOZWNlc3NhcnkoKTtcbiAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLmJ1c3lFbWl0dGVyLmVtaXQodGhpcy5pc0xvYWRpbmcpO1xuICAgICAgICB0aGlzLmJ1c3lTdGFydC5lbWl0KCk7XG4gICAgICB9LCAwKTtcbiAgICB9KTtcbiAgICB0aGlzLm9uU3RvcFN1YnNjcmlwdGlvbiA9IHRyYWNrZXIub25TdG9wQnVzeS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMuYnVzeUVtaXR0ZXIuZW1pdCh0aGlzLmlzTG9hZGluZyk7XG4gICAgICB0aGlzLmJ1c3lTdG9wLmVtaXQoKTtcbiAgICB9KTtcbiAgfVxuXG4gIG5nRG9DaGVjaygpIHtcbiAgICB0aGlzLm9wdGlvbnNOb3JtID0gdGhpcy5ub3JtYWxpemVPcHRpb25zKHRoaXMub3B0aW9ucyk7XG4gICAgdGhpcy5pbnN0YW5jZUNvbmZpZ0hvbGRlci5jb25maWcgPSB0aGlzLm9wdGlvbnNOb3JtO1xuICAgIHRoaXMudHJhY2tlci5sb2FkKHtcbiAgICAgIGJ1c3lMaXN0OiB0aGlzLm9wdGlvbnNOb3JtLmJ1c3ksXG4gICAgICBkZWxheTogdGhpcy5vcHRpb25zTm9ybS5kZWxheSxcbiAgICAgIG1pbkR1cmF0aW9uOiB0aGlzLm9wdGlvbnNOb3JtLm1pbkR1cmF0aW9uXG4gICAgfSk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLmRlc3Ryb3lDb21wb25lbnRzKCk7XG4gICAgdGhpcy5vblN0YXJ0U3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgdGhpcy5vblN0b3BTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgfVxuXG4gIHByaXZhdGUgcmVjcmVhdGVCdXN5SWZOZWNlc3NhcnkoKSB7XG4gICAgaWYgKCF0aGlzLmJ1c3lSZWZcbiAgICAgIHx8IHRoaXMudGVtcGxhdGUgIT09IHRoaXMub3B0aW9uc05vcm0udGVtcGxhdGVcbiAgICAgIHx8IHRoaXMudGVtcGxhdGVOZ1N0eWxlICE9PSB0aGlzLm9wdGlvbnNOb3JtLnRlbXBsYXRlTmdTdHlsZVxuICAgICkge1xuICAgICAgdGhpcy5kZXN0cm95Q29tcG9uZW50cygpO1xuICAgICAgdGhpcy50ZW1wbGF0ZSA9IHRoaXMub3B0aW9uc05vcm0udGVtcGxhdGU7XG4gICAgICB0aGlzLnRlbXBsYXRlTmdTdHlsZSA9IHRoaXMub3B0aW9uc05vcm0udGVtcGxhdGVOZ1N0eWxlO1xuICAgICAgdGhpcy5jcmVhdGVCdXN5KCk7XG4gICAgICB0aGlzLmJ1c3lFbWl0dGVyLmVtaXQodGhpcy5pc0xvYWRpbmcpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgbm9ybWFsaXplT3B0aW9ucyhvcHRpb25zOiBhbnkpOiBJQnVzeUNvbmZpZyB7XG4gICAgaWYgKCFvcHRpb25zKSB7XG4gICAgICBvcHRpb25zID0geyBidXN5OiBbXSB9O1xuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShvcHRpb25zKVxuICAgICAgfHwgaXNQcm9taXNlKG9wdGlvbnMpXG4gICAgICB8fCBvcHRpb25zIGluc3RhbmNlb2YgU3Vic2NyaXB0aW9uXG4gICAgKSB7XG4gICAgICBvcHRpb25zID0geyBidXN5OiBvcHRpb25zIH07XG4gICAgfVxuICAgIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmNvbmZpZ0hvbGRlci5jb25maWcsIG9wdGlvbnMpO1xuICAgIGlmICghQXJyYXkuaXNBcnJheShvcHRpb25zLmJ1c3kpKSB7XG4gICAgICBvcHRpb25zLmJ1c3kgPSBbb3B0aW9ucy5idXN5XTtcbiAgICB9XG4gICAgcmV0dXJuIG9wdGlvbnM7XG4gIH1cblxuICBwcml2YXRlIGRlc3Ryb3lDb21wb25lbnRzKCkge1xuICAgIGlmICh0aGlzLmJ1c3lSZWYpIHtcbiAgICAgIHRoaXMuYnVzeVJlZi5kZXN0cm95KCk7XG4gICAgfVxuICAgIGlmICh0aGlzLmNvbXBvbmVudFZpZXdSZWYpIHtcbiAgICAgIHRoaXMuYXBwUmVmLmRldGFjaFZpZXcodGhpcy5jb21wb25lbnRWaWV3UmVmKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZUJ1c3koKSB7XG4gICAgY29uc3QgZmFjdG9yeSA9IHRoaXMucmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoTmdCdXN5Q29tcG9uZW50KTtcbiAgICBjb25zdCBpbmplY3RvciA9IEluamVjdG9yLmNyZWF0ZSh7XG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6ICdpbnN0YW5jZUNvbmZpZ0hvbGRlcicsXG4gICAgICAgICAgdXNlVmFsdWU6IHRoaXMuaW5zdGFuY2VDb25maWdIb2xkZXJcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6ICdidXN5RW1pdHRlcicsXG4gICAgICAgICAgdXNlVmFsdWU6IHRoaXMuYnVzeUVtaXR0ZXJcbiAgICAgICAgfVxuICAgICAgXSwgcGFyZW50OiB0aGlzLmluamVjdG9yXG4gICAgfSk7XG4gICAgdGhpcy50ZW1wbGF0ZSA9IHRoaXMub3B0aW9uc05vcm0udGVtcGxhdGU7XG4gICAgdGhpcy5idXN5UmVmID0gdGhpcy52Y3IuY3JlYXRlQ29tcG9uZW50KGZhY3RvcnksIDAsIGluamVjdG9yLCB0aGlzLmdlbmVyYXRlTmdDb250ZW50KGluamVjdG9yKSk7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlTmdDb250ZW50KGluamVjdG9yOiBJbmplY3Rvcikge1xuICAgIGlmICh0eXBlb2YgdGhpcy50ZW1wbGF0ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZVRleHQodGhpcy50ZW1wbGF0ZSk7XG4gICAgICByZXR1cm4gW1tlbGVtZW50XV07XG4gICAgfVxuICAgIGlmICh0aGlzLnRlbXBsYXRlIGluc3RhbmNlb2YgVGVtcGxhdGVSZWYpIHtcbiAgICAgIGNvbnN0IGNvbnRleHQgPSB7fTtcbiAgICAgIGNvbnN0IHZpZXdSZWYgPSB0aGlzLnRlbXBsYXRlLmNyZWF0ZUVtYmVkZGVkVmlldyhjb250ZXh0KTtcbiAgICAgIHJldHVybiBbdmlld1JlZi5yb290Tm9kZXNdO1xuICAgIH1cbiAgICBjb25zdCBmYWN0b3J5ID0gdGhpcy5yZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeSh0aGlzLnRlbXBsYXRlKTtcbiAgICBjb25zdCBjb21wb25lbnRSZWYgPSBmYWN0b3J5LmNyZWF0ZShpbmplY3Rvcik7XG4gICAgY29tcG9uZW50UmVmLmluc3RhbmNlLnRlbXBsYXRlTmdTdHlsZSA9IHRoaXMub3B0aW9ucy50ZW1wbGF0ZU5nU3R5bGU7XG4gICAgdGhpcy5jb21wb25lbnRWaWV3UmVmID0gY29tcG9uZW50UmVmLmhvc3RWaWV3O1xuICAgIHRoaXMuYXBwUmVmLmF0dGFjaFZpZXcodGhpcy5jb21wb25lbnRWaWV3UmVmKTtcbiAgICByZXR1cm4gW1tjb21wb25lbnRSZWYubG9jYXRpb24ubmF0aXZlRWxlbWVudF1dO1xuICB9XG5cbn1cbiIsImltcG9ydCB7TW9kdWxlV2l0aFByb3ZpZGVycywgTmdNb2R1bGV9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtCdXN5Q29uZmlnLCBEZWZhdWx0QnVzeUNvbXBvbmVudCwgSUJ1c3lDb25maWd9IGZyb20gJy4vbW9kZWwvYnVzeS1jb25maWcnO1xuaW1wb3J0IHtDb21tb25Nb2R1bGV9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge0J1c3lUcmFja2VyU2VydmljZX0gZnJvbSAnLi9zZXJ2aWNlL2J1c3ktdHJhY2tlci5zZXJ2aWNlJztcbmltcG9ydCB7QnVzeUNvbmZpZ0hvbGRlclNlcnZpY2V9IGZyb20gJy4vc2VydmljZS9idXN5LWNvbmZpZy1ob2xkZXIuc2VydmljZSc7XG5pbXBvcnQge05nQnVzeURpcmVjdGl2ZX0gZnJvbSAnLi9uZy1idXN5LmRpcmVjdGl2ZSc7XG5pbXBvcnQge05nQnVzeUNvbXBvbmVudH0gZnJvbSAnLi9jb21wb25lbnQvbmctYnVzeS9uZy1idXN5LmNvbXBvbmVudCc7XG5cbkBOZ01vZHVsZSh7XG4gIGltcG9ydHM6IFtDb21tb25Nb2R1bGVdLFxuICBkZWNsYXJhdGlvbnM6IFtEZWZhdWx0QnVzeUNvbXBvbmVudCwgTmdCdXN5RGlyZWN0aXZlLCBOZ0J1c3lDb21wb25lbnRdLFxuICBwcm92aWRlcnM6IFtCdXN5Q29uZmlnSG9sZGVyU2VydmljZSwgQnVzeVRyYWNrZXJTZXJ2aWNlXSxcbiAgZXhwb3J0czogW05nQnVzeURpcmVjdGl2ZV0sXG4gIGVudHJ5Q29tcG9uZW50czogW0RlZmF1bHRCdXN5Q29tcG9uZW50LCBOZ0J1c3lDb21wb25lbnRdXG59KVxuZXhwb3J0IGNsYXNzIE5nQnVzeU1vZHVsZSB7XG4gIHN0YXRpYyBmb3JSb290KGNvbmZpZzogSUJ1c3lDb25maWcpOiBNb2R1bGVXaXRoUHJvdmlkZXJzIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmdNb2R1bGU6IE5nQnVzeU1vZHVsZSxcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICB7cHJvdmlkZTogQnVzeUNvbmZpZywgdXNlVmFsdWU6IGNvbmZpZ31cbiAgICAgIF1cbiAgICB9O1xuICB9XG59XG4iXSwibmFtZXMiOlsidHNsaWJfMS5fX3ZhbHVlcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBO0lBUUU7S0FBaUI7O2dCQUxsQixVQUFVLFNBQUM7b0JBQ1YsVUFBVSxFQUFFLE1BQU07aUJBQ25COzs7OztzQ0FMRDs7Ozs7OztJQ0lBO0lBVUUsb0JBQVksTUFBd0I7O1FBQXhCLHVCQUFBLEVBQUEsV0FBd0I7O1lBQ2xDLEtBQXFCLElBQUEsS0FBQUEsU0FBQSxNQUFNLENBQUMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLENBQUEsZ0JBQUEsNEJBQUU7Z0JBQW5ELElBQU0sTUFBTSxXQUFBO2dCQUNmLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssU0FBUyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsR0FBRyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsQ0FBQzthQUM3Rjs7Ozs7Ozs7O0tBQ0Y7cUJBbEJIO0lBbUJDLENBQUE7QUFmRDtJQTJDRSw4QkFBb0Qsb0JBQWlEO1FBQWpELHlCQUFvQixHQUFwQixvQkFBb0IsQ0FBNkI7S0FD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